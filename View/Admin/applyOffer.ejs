<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        padding: 0;
    }

    .main-wrap {
        padding: 20px;
    }

    .content-header {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 20px;
    }

    .content-title {
        margin: 0;
        color: #333;
    }

    #filterButtons {
        background-color: #3BB77E;
        color: white;
        transition: 0.5s;
        box-shadow: rgba(0, 0, 0, 0.16) 0px 3px 6px, rgba(0, 0, 0, 0.23) 0px 3px 6px;
        border: none;
        cursor: pointer;
        border-radius: 8px;
        padding: 10px 20px;
        font-size: 16px;
    }

    #filterButtons:hover {
        background-color: #004424;
        box-shadow: rgba(0, 0, 0, 0.16) 0px 1px 4px;
    }

    .card {
        background-color: #fff;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .card-body {
        padding: 20px;
    }

    .table {
        width: 100%;
        margin-bottom: 1rem;
        background-color: transparent;
    }

    .table th, .table td {
        padding: 12px;
        vertical-align: middle;
        border-top: 1px solid #dee2e6;
    }

    .table thead th {
        background-color: #e9ecef;
        color: #495057;
        border-bottom: 2px solid #dee2e6;
    }

    .table tbody tr:hover {
        background-color: #f1f1f1;
    }

    .form-control {
        padding: 10px 15px;
        font-size: 14px;
    }

    .footer {
        padding: 20px;
        background-color: #fff;
        text-align: center;
        border-top: 1px solid #dee2e6;
        margin-top: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .footer script {
        margin-right: 5px;
    }

    .itemside {
        display: flex;
        align-items: center;
    }

    .itemside .left {
        margin-right: 15px;
    }

    .img-sm {
        width: 60px;
        height: auto;
    }

    .text-end {
        text-align: right;
    }
</style>
<%- include('./layouts/header.ejs') %>
<main class="main-wrap">
    <section class="content-main">
        <div class="content-header">
            <div class="d-flex justify-content-between align-items-center">
                <h2 class="content-title card-title">Add Offer to Product</h2>   
            </div>
            <a href="/admin/currentofferProduct?offerID=<%= offerID %>"><button class="form-control" id="filterButtons">Current Products</button></a>
        </div>
        <div>
            <h2>
                <span>Offer Info</span>
            </h2>
                <h3>
                    <span>Name: <%= offerData.name %></span>
                </h3>
                <h3>
                    <span>Discount: <%= offerData.discount %>%</span>
                </h3>

        </div>
        <br>
        <div class="card mb-4">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th scope="col"></th>
                                <th scope="col">Images & Title</th>
                                <th scope="col">Price</th>
                                <th scope="col" class="text-end" style="padding-right: 40px;">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if (productData.length == 0) { %>
                                <tr>
                                    <td colspan="4" class="text-center">No products available</td>
                                </tr>
                            <% } else { %>
                                <% productData.forEach(product => { %>
                                    <tr>
                                        <td></td>
                                        <td>
                                            <div class="itemside">
                                                <div class="left">
                                                    <img src="productImages/<%= product.image[0] %>" class="img-sm img-thumbnail" alt="Item" />
                                                </div>
                                                <div class="info">
                                                    <h6 class="mb-0"><%= product.productTitle %></h6>
                                                </div>
                                            </div>
                                        </td>
                                        <td>$<%= product.price %></td>
                                        <td class="text-end">
                                            <button class="form-control" id="filterButtons" onclick="addOfferProduct('<%= product._id %>', '<%= offerID %>')">Add Offer</button>
                                        </td>
                                    </tr>
                                <% }) %>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>
    <!-- content-main end// -->
    <footer class="footer font-xs">
        <div class="row pb-30 pt-15">
            <div class="col-sm-6">
                <script>
                    document.write(new Date().getFullYear());
                </script>
                &copy; Nest - HTML Ecommerce Template.
            </div>
            <div class="col-sm-6">
                <div class="text-sm-end">All rights reserved</div>
            </div>
        </div>
    </footer>
</main>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    function addOfferProduct(a, b) {
        axios.get(`/admin/apply?id=${a}&offerID=${b}`)
            .then(response => {
                if (response.data.Done) {
                    Swal.fire({
                        title: "Offer Added",
                        icon: "success",
                        confirmButtonColor: "#3085d6",
                        confirmButtonText: "OK",
                        allowOutsideClick: false,
                    }).then(result => {
                        if (result.isConfirmed) {
                            window.location.reload();
                        }
                    });
                } else {
                    Swal.fire({
                        title: "Failed",
                        icon: "error",
                        confirmButtonColor: "#3085d6",
                        confirmButtonText: "OK"
                    });
                }
            }).catch(error => {
                console.log(error);
            });
    }
</script>

<script src="/assets/js/vendors/jquery-3.6.0.min.js"></script>
<script src="/assets/js/vendors/bootstrap.bundle.min.js"></script>
<script src="/assets/js/vendors/select2.min.js"></script>
<script src="/assets/js/vendors/perfect-scrollbar.js"></script>
<script src="/assets/js/vendors/jquery.fullscreen.min.js"></script>
<!-- Main Script -->
<script src="/assets/js/main.js" type="text/javascript"></script>
</body>
</html>
